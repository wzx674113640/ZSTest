var tjconf=require("./h-conf");!function(){function o(c,a,d){function t(){return new Promise(function(e,t){let n=wx.getStorageSync("tjxx");if(void 0!==n.openid)for(d in n)c[d]=n[d];if(""==c.cd)e("");else{_++;wx.request({url:"https://ad.ali-yun.wang/api/app_jump/in",data:c,header:{se:u||"",op:h||"",img:g||""},method:"POST",success:function(t){wx.setStorageSync("tjxx",t.data),clearTimeout(r),!0,void 0!==t.data.rtime&&parseInt(t.data.rtime)>0?r=setTimeout(function(){o(c,e,2)},1e3*parseInt(t.data.rtime)):void 0!==n.rtime&&parseInt(n.rtime)>0&&(r=setTimeout(function(){o(c,e,2)},1e3*parseInt(n.rtime)))},fail:function(){!0,void 0!==n.rtime&&parseInt(n.rtime)>0&&(clearTimeout(r),r=setTimeout(function(){o(c,e,2)},1e3*parseInt(n.rtime)))}})}})}c.rq_c=_,c.cd=w,c.ifo=s,c.ak=n.app_key,c.uu=i,c.v=e,c.st=Date.now(),c.ev=a,c.wsr=p,c.ufo=function(e){if(void 0===e||""===e)return"";var t={};for(var n in e)"rawData"!=n&&"errMsg"!=n&&(t[n]=e[n]);return t}(c.ufo),c.ec=f,void 0===d?wx.Queue.push(t):t()}function c(e){var t={};for(var n in e)t[n]=e[n];return t}wx.Queue=new function(){this.concurrency=200,this.queue=[],this.tasks=[],this.activeCount=0;var e=this;this.push=function(t){this.tasks.push(new Promise(function(n,r){var o=function(){e.activeCount++,t().then(function(e){n(e)}).then(function(){e.next()})};e.activeCount<e.concurrency?o():e.queue.push(o)}))},this.all=function(){return Promise.all(this.tasks)},this.next=function(){e.activeCount--,e.queue.length>0&&e.queue.shift()()}},wx.Queue.all();var e="1.0.0",n=tjconf;""===n.app_key&&console.error("请在配置文件中填写您的app_key"),n.app_key=n.app_key.replace(/\s/g,"");var r,s="",i=function(){var e="";try{e=wx.getStorageSync("h_stat_uuid"),wx.setStorageSync("h_ifo",!0)}catch(t){e="uuid_getstoragesync"}if(e)s=!1;else{e=function(){function e(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return e()+e()+e()+e()+e()+e()+e()+e()}(),s=!0;try{wx.setStorageSync("h_stat_uuid",e)}catch(e){wx.setStorageSync("h_stat_uuid","uuid_getstoragesync")}}return e}(),a={},u="",h="",f=0,_="",p=wx.getLaunchOptionsSync(),d=Date.now(),l=(Date.now(),Math.floor(1e7*Math.random()),Date.now(),Math.floor(1e7*Math.random()),0),v="",g="",w="",y=!0,S=["h_SendEvent","h_OnShareAppMessage","h_ShareAppMessage","h_SendSession","h_SendOpenid"];Promise.all([new Promise(function(e,t){""==w&&wx.login({success:function(t){w=t.code,e("")}})}),new Promise(function(e,t){wx.getNetworkType({success:function(t){e(t)},fail:function(){e("")}})}),new Promise(function(e,t){n.getLocation?wx.getLocation({success:function(t){e(t)},fail:function(){e("")}}):wx.getSetting({success:function(t){t.authSetting["scope.userLocation"]?(wx.getLocation({success:function(t){e(t)},fail:function(){e("")}}),e("")):e("")},fail:function(){e("")}})})]).then(function(e){""!==e[2]?(a.lat=e[2].latitude||"",a.lng=e[2].longitude||"",a.spd=e[2].speed||""):(a.lat="",a.lng="",a.spd=""),""!==e[1]?a.nt=e[1].networkType||"":a.nt="";var t=c(a);""!==e[0]&&(t.ufo=e[0],v=e[0]),o(t,"init")}),wx.onShow(function(e){_=0,p=e,l=Date.now(),y||(""+Date.now()+Math.floor(1e7*Math.random()),s=!1,wx.setStorageSync("h_ifo",!1)),y=!1;var t=c(a),n=c(a);t.sm=l-d,e.query.h_share_src&&e.shareTicket&&"1044"===e.scene?(n.tp="h_share_click",new Promise(function(e,t){"1044"==p.scene?wx.getShareInfo({shareTicket:p.shareTicket,success:function(t){e(t)},fail:function(){e("")}}):e("")}).then(function(e){n.ct=e,o(n,"event")})):e.query.h_share_src&&(n.tp="h_share_click",n.ct="1",o(n,"event")),o(t,"show")}),wx.onHide(function(){var e=c(a);e.dr=Date.now()-l,""===v?wx.getSetting({success:function(t){t.authSetting["scope.userInfo"]?wx.getUserInfo({success:function(t){e.ufo=t,v=t,g=function(e){for(var t="",n=0;n<e.length;n++)e[n].length>t.length&&(t=e[n]);return t}(t.userInfo.avatarUrl.split("/")),o(e,"hide")}}):o(e,"hide")}}):o(e,"hide")}),wx.onError(function(e){var t=c(a);t.tp="h_error_message",t.ct=e,f++,o(t,"event")});for(var x={h_SendEvent:function(e,t){var n=c(a);""!==e&&"string"==typeof e&&e.length<=255?(n.tp=e,"string"==typeof t&&t.length<=255?(n.ct=String(t),o(n,"event")):"object"==(void 0===t?"undefined":_typeof(t))?(JSON.stringify(t).length>=255&&console.error("自定义事件参数不能超过255个字符"),n.ct=JSON.stringify(t),o(n,"event")):void 0===t||""===t?o(n,"event"):console.error("事件参数必须为String,Object类型,且参数长度不能超过255个字符")):console.error("事件名称必须为String类型且不能超过255个字符")},h_OnShareAppMessage:function(e){wx.updateShareMenu({withShareTicket:!0,complete:function(){wx.onShareAppMessage(function(){var t=e(),n="",r="";n=void 0!==t.success?t.success:"",r=void 0!==t.fail?t.fail:"";var s;s=void 0!==p.query.h_share_src?void 0!==t.query?(p.query.h_share_src.indexOf(i),t.query+"&h_share_src="+p.query.h_share_src+","+i):(p.query.h_share_src.indexOf(i),"h_share_src="+p.query.h_share_src+","+i):void 0!==t.query?t.query+"&h_share_src="+i:"h_share_src="+i;var u=c(a);return t.query=s,u.ct=t,u.tp="h_share_chain",o(u,"event"),t.success=function(e){u.tp="h_share_status",o(u,"event"),""!==n&&n(e)},t.fail=function(e){u.tp="h_share_fail",o(u,"event"),""!==r&&r(e)},t})}})},h_ShareAppMessage:function(e){var t=e,n="",r="";n=void 0!==t.success?t.success:"",r=void 0!==t.fail?t.fail:"";var s;s=void 0!==p.query.h_share_src?void 0!==t.query?(p.query.h_share_src.indexOf(i),t.query+"&h_share_src="+p.query.h_share_src+","+i):(p.query.h_share_src.indexOf(i),"h_share_src="+p.query.h_share_src+","+i):void 0!==t.query?t.query+"&h_share_src="+i:"h_share_src="+i,t.query=s;var u=c(a);u.ct=t,u.tp="h_share_chain",o(u,"event"),t.success=function(e){u.tp="h_share_status",o(u,"event"),""!==n&&n(e)},t.fail=function(e){u.tp="h_share_fail",o(u,"event"),""!==r&&r(e)},wx.updateShareMenu({withShareTicket:!0,complete:function(){wx.shareAppMessage(t)}})},h_SendSession:function(e){if(""!==e&&e){var t=c(a);t.tp="session",t.ct="session",u=e,""===v?wx.getSetting({success:function(e){e.authSetting["scope.userInfo"]?wx.getUserInfo({success:function(e){t.ufo=e,o(t,"event")}}):o(t,"event")}}):(t.ufo=v,""!==v&&(t.gid=""),o(t,"event"))}else console.error("请传入从后台获取的session_key")},h_SendOpenid:function(e){if(""!==e&&e){h=e;var t=c(a);t.tp="openid",t.ct="openid",o(t,"event")}else console.error("openID不能为空")}},m=0;m<S.length;m++)!function(e,t){Object.defineProperty(wx,e,{value:t,writable:!1,enumerable:!0,configurable:!0})}(S[m],x[S[m]]);try{var q=wx.getSystemInfoSync();a.br=q.brand||"",a.md=q.model,a.pr=q.pixelRatio,a.sw=q.screenWidth,a.sh=q.screenHeight,a.ww=q.windowWidth,a.wh=q.windowHeight,a.lang=q.language,a.wv=q.version,a.sv=q.system,a.wvv=q.platform,a.fs=q.fontSizeSetting,a.wsdk=q.SDKVersion,a.bh=q.benchmarkLevel||"",a.bt=q.battery||"",a.wf=q.wifiSignal||"",a.lng="",a.lat="",a.nt="",a.spd="",a.ufo=""}catch(e){}}();